(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{12:function(n,e,t){"use strict";t.r(e),t(13),t(18),t(20),t(1),t(2),t(3);var r=function(){var n=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?"phone":"PC",e=window.navigator.userAgent,t=RegExp(/zhidao/i);return new Promise(function(r,i){if("phone"==n&&t.test(e))var a=0,o=setInterval(function(){a++,window.bridge&&(r(),clearInterval(o)),a>=10&&(clearInterval(o),i())},100)})},i=function(n){var e=n||null;return new Promise(function(n,t){r().then(function(){window.bridge.getParamsSignature(e,function(e){e||t(),n(e)})})})},a=t(0),o=t(4),s="",c="";function d(n){var e,t,r,a;e=n.num,t=n.size,r=function(n,e){c.endBySize(n.length,e),function(n){for(var e=document.getElementById("dataList"),t=0;t<n.length;t++){var r=n[t],i="",a="",o="";if(r.status)switch(r.relationship){case 0:i="applyFor",a="已申请",o="已申请添加对方为好友";break;case 1:i="friends",a="",o="已是好友";break;case-1:i="addFriendBtn",a="添加好友",o="已注册APP"}else i="wakeUp",a="唤醒",o="对方已领取,未注册APP";var s='<li class="invite_item">\n        <img class="itemPic" src='+r.headImgUrl+' alt="">\n        <div class="itemInfo">\n            <span class="name">'+r.userName+'</span>\n            <span class="register scaleFont">'+o+'</span>\n        </div>\n        <div class="btn_box" data-id=\''+r.userId+"' data-name='"+r.userName+"'\n            data-status='"+r.status+"' data-telphone='"+r.telphone+'\'>\n            <button type="button" class="btn '+i+'">'+a+"</button>\n        </div>\n    </li>",c=document.createElement("li");c.innerHTML=s,e.appendChild(c)}}(n)},a=function(){c.endErr()},i({pageNum:e,pageSize:t}).then(function(n){if(!n)throw new Error("getAwardList获取列表接口签名失败");var e=n;$.ajax({url:"/activity/invite/getAwardList",type:"GET",data:e,success:function(n){if(!n)throw new Error("inviteList接口返回错误");var e=JSON.parse(n),t=e.code,i=(e.msg,e.result);if(0==t){var o=i.data.registerList;r&&r(o,i.data.total)}else a&&a()},error:function(n){throw new Error(n,"inviteList接口请求错误")}})}).catch(function(n){throw new Error(n,"err")})}function u(n,e){var t=n||"",r=e||"";if(!t||!r)throw new Error("参数错误");$("#toast").html(t),$("#toast").show();var i=setTimeout(function(){clearInterval(i),$("#toast").hide()},r)}window.onload=function(){var n,e;o("400501",{}),(e=n||null,new Promise(function(n,t){r().then(function(){window.bridge.trackerPublicParams(e,function(e){e||t(),n(e)})})})).then(function(n){}),i().then(function(n){if(!n)throw new Error("无参数-公共签名获取失败");var e=n;$.ajax({url:"/activity/invite/inviteList",type:"GET",data:e,success:function(n){if(!n)throw new Error("inviteList接口返回错误");var e=JSON.parse(n),t=e.code,r=e.message,i=e.result;if(0!=t)throw new Error(r);var a=i.data;$(".bannerNum").html(a.userInviteAward),$(".inviteAward").html(a.inviteAward),$(".inviteCount").html(a.inviteCount),s=a.userName},error:function(n){throw new Error(n,"inviteList接口请求错误")}})}).catch(function(n){throw new Error(n,"err")}),c&&c.destroy(),c=new MeScroll("mescroll",{up:{auto:!0,callback:d,isBounce:!1,clearEmptyId:"dataList",page:{num:0,size:5},noMoreSize:5,htmlNodata:"<p class='upwarp-nodata'>-- 没有更多数据了 --</p>",empty:{warpId:"dataList",tip:"这里空空如也，快去邀请好友注册领取奖励吧~"}}})},$("#dataList").on("click",".btn_box",function(){var n=$(this),e=$(this).attr("data-id"),t=$(this).attr("data-name"),r=$(this).attr("data-status"),c=$(this).attr("data-telphone");0==n.find(".isDisabled").length&&("0"!==r?(o("400521",{id:e,name:t}),function(n,e){if(!e)throw new Error("userID is null");window.bridge.addIMFriend&&window.bridge.addIMFriend({userId:e,source:"AddSource_Type_Rec"},function(e){if(!e)throw new Error("添加好友bridge返回错误");0==e.code&&n.find(".addFriendBtn").removeClass("addFriendBtn").addClass("applyFor").attr("disabled","disabled").html("已申请")})}(n,e)):(o("400522",{}),function(n){var e=""+c;if(!s||!e)throw new Error("name,phone错误");i({message:encodeURIComponent('["'+s+'"]'),phone:e,templateId:211321,sign:"蘑菇智行",appId:"phoenix"}).then(function(n){if(!n)throw new Error("appSendToSingle发送短信接口签名失败");var e=Object(a.b)(n);$.ajax({url:"/push/sms/appSendToSingle",type:"GET",data:e,success:function(n){if(!n)throw new Error("appSendToSingle发送短信接口返回失败");u("已向对方发送注册邀请",2e3);var e=JSON.parse(n),t=e.code,r=e.msg;0==t?u("已向对方发送注册邀请",2e3):u(r)},error:function(n){throw new Error(n,"appSendToSingle接口请求错误")}})}).catch(function(n){throw new Error(n,"err")})}()))}),$(".shareBox").on("click",".shareItem",function(){!function(n){if(!s)throw new Error("没有userName，无法分享");var e="",t=n||"",r=null;i().then(function(n){var i=n;switch(e=window.location.origin+"/femushroom/commendprize/phone.html?userName="+s+"&publicParams="+encodeURIComponent(JSON.stringify(i)),t){case"wechat":o("400503",{}),r={icon:"http://img.zhidaohulian.com/fileServer/defaultPath/058bbc232b8b5ed0947f297b51eb8426.png",title:"快来跟我加入蘑菇智行，领取金币，一起享受老司机福利吧",content:"领金币，可兑换商城礼品哦",url:e};break;case"wechat_timeline":o("400504",{}),r={icon:"http://img.zhidaohulian.com/fileServer/defaultPath/058bbc232b8b5ed0947f297b51eb8426.png",title:"快来跟我加入蘑菇智行，领取金币，一起享受老司机福利吧",content:"领金币，可兑换商城礼品哦",url:e}}if(!window.bridge.channelShare)throw new Error("bridge.channelShare is not defined");window.bridge.channelShare({channel:t,data:r},function(n){})}).catch(function(n){throw new Error(n,"err")})}($(this).data("share"))}),$(".lookRules").on("click",function(){o("400502",{}),setTimeout(function(){window.location.href=window.location.origin+"/femushroom/commendprize/rules.html"},200)})},18:function(n,e){},20:function(n,e){}},[[12,0,2,1]]]);
//# sourceMappingURL=index.146a378.js.map